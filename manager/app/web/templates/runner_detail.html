<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Runner Details - Monitoring</title>
    <link rel="icon" type="image/png" href="/static/favicon.png?version={{ version }}">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <!-- App -->
    <link rel="stylesheet" href="/static/esup-runner.css?version={{ version }}">
    <script src="/static/esup-runner.js?version={{ version }}" defer></script>
</head>
<body class="{% if dark_mode_enabled %}theme-dark{% else %}theme-light{% endif %} container py-4">

    <div class="row mb-4">
        <div class="col">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h1 class="h2 mb-2">Runner Details</h1>
                    <p class="text-subtle mb-0"></p>
                </div>
                <div class="text-end">
                    <div class="btn-group">
                        <a href="/admin" class="btn btn-outline-secondary">
                            <i class="bi bi-arrow-left"></i> Back to Dashboard
                        </a>
                        <!-- Actions -->
                        <button id="refreshBtn" class="btn btn-primary">
                            <i class="bi bi-arrow-clockwise"></i> Refresh
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main detail card -->
    <div class="card border-0 shadow-sm mb-4">
        <div class="card-body">
            <!-- Runner header -->
            <div class="task-header {% if runner.status == 'online' %}border-success {% else %}border-danger{% endif %}">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h2 class="h4 mb-2">Runner #{{ runner.id }}</h2>
                        <p class="text-subtle mb-0">
                            Last heartbeat: {{ runner.last_heartbeat }}
                        </p>
                    </div>
                    <div class="col-md-4 text-md-end">
                        <span class="badge task-status-badge {% if runner.status == 'online' %}bg-success{% else %}bg-danger{% endif %}">
                            {{ runner.status | upper }}
                        </span>
                    </div>
                </div>
            </div>

            <!-- Runner metadata -->
            <div class="detail-section">
                <h3 class="h5 mb-3">General Information</h3>
                <div class="metadata-list">
                    <div class="metadata-item">
                        <span class="metadata-label">Runner ID:</span>
                        <span class="text-subtle">{{ runner.id }}</span>
                    </div>
                    <div class="metadata-item">
                        <span class="metadata-label">Runner version:</span>
                        <span class="text-subtle">{{ runner.version }}</span>
                    </div>
                    <div class="metadata-item">
                        <span class="metadata-label">Runner task types:</span>
                        <span class="text-subtle">
                                {% set task_icons = {
                                    'encoding': {'label': 'Encoding', 'icon': 'bi-explicit', 'title': 'This runner handles encoding tasks.'},
                                    'studio': {'label': 'Studio', 'icon': 'bi-record-btn', 'title': 'This runner handles studio tasks.'},
                                    'transcription': {'label': 'Transcription', 'icon': 'bi-badge-cc', 'title': 'This runner handles transcription tasks.'}
                                } %}
                                {% for t, meta in task_icons.items() %}
                                    {% if t in runner.task_types %}&nbsp;[{{ meta.label }} <i title="{{ meta.title }}" class="bi {{ meta.icon }}" data-bs-toggle="tooltip"></i>]{% endif %}
                                {% endfor %}
                        </span>
                    </div>
                    <div class="metadata-item">
                        <span class="metadata-label">URLs:</span>
                        <span class="text-subtle">
                            <ul>
                            <li>
                                Runner API:
                                <a href="{{ runner.url }}" class="link-body-emphasis" target="_blank" title="Open runner URL in new tab" data-bs-toggle="tooltip">
                                    {{ runner.url }}
                                </a>
                            </li>
                            <li>
                                OpenAPI specification:
                                <a href="{{ runner.url }}/openapi.json" class="link-body-emphasis" target="_blank" title="Open runner URL in new tab" data-bs-toggle="tooltip">
                                    {{ runner.url }}/openapi.json
                                </a>
                            </li>
                            <li>
                                Swagger Docs:
                                <a href="{{ runner.url }}/docs" class="link-body-emphasis" target="_blank" title="Open runner URL in new tab" data-bs-toggle="tooltip">
                                    {{ runner.url }}/docs
                                </a>
                            </li>
                            <li>
                                Redoc Docs:
                                <a href="{{ runner.url }}/redoc" class="link-body-emphasis" target="_blank" title="Open runner URL in new tab" data-bs-toggle="tooltip">
                                    {{ runner.url }}/redoc
                                </a>
                            </li>
                            </ul>
                        </span>
                    </div>
                    <div class="metadata-item">
                        <span class="metadata-label">Status:</span>
                        <span class="badge {% if runner.status == 'online' %}bg-success{% else %}bg-danger{% endif %}">
                            {{ runner.status }}
                        </span>
                    </div>
                    <div class="metadata-item">
                        <span class="metadata-label">Availability:</span>
                        <span class="badge {% if runner.availability == 'available' %}bg-primary{% else %}bg-secondary{% endif %}">
                            {{ runner.availability }}
                        </span>
                    </div>
                    <div class="metadata-item">
                        <span class="metadata-label">Token:</span>
                        <span class="text-subtle">{{ runner.token }}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="text-center text-subtle">
        <small>Runner Manager v{{ version }} / Last update: {{ last_update }}</small>
    </div>

</body>
</html>
